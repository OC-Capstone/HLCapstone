<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Testamentary Wishes</title>
  <!-- Include Tailwind CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.0.2/dist/tailwind.min.css" rel="stylesheet">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
</head>

<body class="bg-white font-sans">
  <div id="mySidenav" class="sidenav">

  </div>
  <!-- Container -->
  <div>
    <!-- Header -->
    <div class="fixed top-0 left-0 w-full h-16 bg-red-600 flex justify-between items-center px-4 z-1">
      <span style="font-size:30px;cursor:pointer" onclick="openNav()">&#9776;</span>
      <div id="title" class="text-white font-lato font-bold text-shadow-md text-2xl sm:text-4xl md:text-4xl"
        style="font-family: 'Lato', sans-serif; text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000;">
        Testamentary Wishes
      </div>
      <a href="#">
        <i class="fa-solid fa-trash text-white text-4xl"></i>
      </a>
    </div>

    <!-- main-->

    <div id="main_div" class="border-2 text-gray-700 rounded-lg p-4 mt-12 max-w-5/6"
      style="min-height: calc(100vh - 14rem)">
      <div id="beneficiarybtnDiv" class="flex flex-col items-center justify-top h-screen">
        <button type="button" id="beneficiaryListBTN"
          class="self-stretch h-12 mt-1 px-3 mb-12 py-2 bg-white rounded-none border border-black flex justify-center items-center gap-3">
          + Add New beneficiary
        </button>
        <div class="hidden flex-col flex flex-start" id="beneficiaryListDiv">
          <select id="beneficiaryList" size="3">
          </select>
          <button id="getSelectedOption">Get Selected Option</button>
        </div>
      </div>
    </div>




    <div class="footer w-full h-32 bg-white absolute bottom-0 inset-x-0 flex justify-center grid grid-cols-3 gap-4">

      <div class="flex items-center justify-center">
        <a href="beneficiary.html">
          <img src="../res/iconsHL/arrow_back.png" width="150px" height="100px">
        </a>
      </div>
      <div class="flex flex-col items-center">
        <div class="h-1/4 flex items-center justify-center">

        </div>
        <div class="h-3/4 flex items-center justify-center"><img src="../res/iconsHL/dots.jpg"></div>
      </div>
      <div class="flex items-center justify-center">
        <a href="">
          <img src="../res/iconsHL/arrow_next.png" width="150px" height="100px">
        </a>
      </div>
    </div>


    <!-- need -->
    <script>
      // var entryDiv = $("<div>").addClass("w-full max-w-screen-sm h-24 px-12 py-2 mt-12 rounded border border-black flex items-center");
      // var profilePicture = $("<img>").attr("src", "../res/prof_pic.png").attr("alt", "Profile Picture").addClass("h-full object-contain");
      // var beneficiaryInfoDiv = $("<div>").addClass("ml-2");
      // var fullName = $("<p>").text(entry.fullName).addClass("text-lg md:text-xl mb-2 lg:text-2xl");
      // var relationship = $("<p>").text(entry.relationshipToDeceased).addClass("text-md md:text-lg lg:text-xl");

      $(document).ready(function () {
        //function to add a new benficiary to list
        function addBeneficiary(name, relation) {
          // Create a new option element
          var option = $('<option></option>');

          // Set the text and value of the option
          option.text(name + " - " + relation);
          option.val(name); // Set the value to the beneficiary's name (you can adjust this as needed)

          // Append the option to the dropdown list
          $('#beneficiaryList').append(option);
          $('#beneficiaryListDiv').removeClass("hidden");
        }

        $('#getSelectedOption').click(function () {
          // Get the selected option
          var selectedOption = $('#beneficiaryList').find('option:selected');

          // Get the name and relationship from the selected option
          var selectedName = selectedOption.text().split(' - ')[0]; // Extract name
          var selectedRelation = selectedOption.text().split(' - ')[1]; // Extract relationship

          // Log the selected name and relationship (you can modify this as needed)
          //What happens when you click GET SELECTED OPTION after clicking a beneficiary in list 
          alert("Selected Name: " + selectedName + "\n" + "Selected Relationship: " + selectedRelation);
          benSplit(selectedName, selectedRelation);
          
        });
        //clicking the add new beneficiary button
        $('#beneficiaryListBTN').click(function () {
          console.log("button");
          //hiding add new beneficiary button
          $('#beneficiaryListBTN').addClass("hidden");
          $('#beneficiarybtnDiv').removeClass("flex");

          xhttp = new XMLHttpRequest();
          xhttp.onreadystatechange = function () {
            if (this.readyState == 4 && this.status == 200) {
              //array from php using JSON
              var jsonData = JSON.parse(this.responseText);

              jsonData.forEach(function (item) {
                var firstname = item.firstname;
                var relationship = item.relationshipToDeceased;
                console.log(firstname + " " + relationship);
                addBeneficiary(firstname, relationship);
              });
            } else {

            }
          }

          xhttp.open("POST", "beneficiarySplit.php", true);
          xhttp.send();
        });

        //getselected option from list box.
        

      });
    </script>
    <script src="beneficiarySplit.js"></script>
</body>

</html>